<!-- inventory_report_form.html -->
<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>تقرير حركة المخزون</title>
</head>
<body>
    <h1>تقرير حركة المخزون</h1>
    <form method="post">
        {% csrf_token %}
        <label for="warehouse_id">المخزن:</label>
        <select name="warehouse_id" id="warehouse_id" required>
            {% for warehouse in warehouses %}
                <option value="{{ warehouse.id }}">{{ warehouse.name }}</option>
            {% endfor %}
        </select>
        
        <label for="start_date">تاريخ البداية:</label>
        <input type="date" name="start_date" id="start_date" required> <!-- إضافة id -->
        
        <label for="end_date">تاريخ النهاية:</label>
        <input type="date" name="end_date" id="end_date" required> <!-- إضافة id -->
        
        <button type="submit">توليد التقرير</button>
        <button type="submit" name="generate_pdf" value="true">توليد PDF</button>
        <button type="submit" name="generate_excel" value="true">توليد Excel</button>
    </form>
    
    {% if report_data %}
    <h2>التقرير من {{ start_date }} إلى {{ end_date }}</h2>

    <h3>عمليات الوارد للمخزن</h3>
    <table border="1">
        <tr>
            <th>تاريخ الوارد</th>
            <th>رقم الوثيقة</th>
            <th>المورد</th>
            <th>الكمية المستوردة</th>
        </tr>
        {% for row in report_data.Receiving %}
        <tr>
            <td>{{ row.receiving_date }}</td>
            <td>{{ row.document_number }}</td>
            <td>{{ row.supplier.name }}</td>
            <td>{{ row.imported_quantity }}</td>
        </tr>
        {% endfor %}
    </table>

    <h3>عمليات الصادر من المخزن</h3>
    <table border="1">
        <tr>
            <th>تاريخ الصادر</th>
            <th>رقم الوثيقة</th>
            <th>المستفيد</th>
            <th>الكمية المصروفة</th>
        </tr>
        {% for row in report_data.Dispatch %}
        <tr>
            <td>{{ row.dispatch_date }}</td>
            <td>{{ row.document_number }}</td>
            <td>{{ row.beneficiary.name }}</td>
            <td>{{ row.quantity_dispatched }}</td>
        </tr>
        {% endfor %}
    </table>

    <h3>عمليات المرتجع</h3>
    <table border="1">
        <tr>
            <th>تاريخ المرتجع</th>
            <th>رقم الوثيقة</th>
            <th>المورد</th>
            <th>الكمية المرتجعة</th>
        </tr>
        {% for row in report_data.Return %}
        <tr>
            <td>{{ row.return_date }}</td>
            <td>{{ row.document_number }}</td>
            <td>{{ row.supplier.name }}</td>
            <td>{{ row.returned_quantity }}</td>
        </tr>
        {% endfor %}
    </table>

    <h3>عمليات التلف</h3>
    <table border="1">
        <tr>
            <th>تاريخ التلف</th>
            <th>رقم الوثيقة</th>
            <th>الصنف</th>
            <th>الكمية التالفة</th>
        </tr>
        {% for row in report_data.Damage %}
        <tr>
            <td>{{ row.damage_date }}</td>
            <td>{{ row.document_number }}</td>
            <td>{{ row.item.name }}</td>
            <td>{{ row.damaged_quantity }}</td>
        </tr>
        {% endfor %}
    </table>
    {% endif %}
</body>
</html>
